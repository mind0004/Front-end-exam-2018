{"version":3,"sources":["scripts\\donate-1.js"],"names":["config","firebase","initializeApp","db","firestore","settings","body","document","querySelector","init","addEventListener","slider","getElementById","sliderInput","sliderInputLine","allowStep2","checkInput","e","log","target","value","isNaN","style","background","removeProperty","oninput","dropdownOpen","currentPeriod","dropdown","dropdownLIS","dropdownUL","dropdownLine","toggleDropdown","height","width","addClickEventToLI","querySelectorAll","forEach","togglePeriod","textContent","innerHTML","step1Button","proceedToStep2","preventDefault","donationInput","type","checked","step1Data","setItem","JSON","stringify","overview","recentDonorsTemplate","content","topDonorsTemplate","getOverview","collection","get","then","querySnapshot","doc","data","displayRecentDonors","displayTopDonors","catch","error","recentDonors","latestDonations","clone","cloneNode","elem","name","amount","currency","appendChild","topDonors"],"mappings":"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","file":"donate-1.aa1c652e.map","sourceRoot":"..\\src","sourcesContent":["// FIREBASE\r\nvar config = {\r\n  apiKey: \"AIzaSyBrTXlPTks8CPKRbZBSDnTXpPaotL4Wpwg\",\r\n  authDomain: \"polyeco-eda86.firebaseapp.com\",\r\n  databaseURL: \"https://polyeco-eda86.firebaseio.com\",\r\n  projectId: \"polyeco-eda86\",\r\n  storageBucket: \"polyeco-eda86.appspot.com\",\r\n  messagingSenderId: \"86781747630\"\r\n};\r\nfirebase.initializeApp(config);\r\n\r\n// Initialize Cloud Firestore through Firebase\r\nconst db = firebase.firestore();\r\n\r\n// Disable deprecated features\r\ndb.settings({\r\n  timestampsInSnapshots: true\r\n});\r\n\r\n//Mini\r\n\r\n/* ==========================================================================\r\n   Global variables\r\n   ========================================================================== */\r\nconst body = document.querySelector(\"body\");\r\n\r\n/* ==========================================================================\r\n      Initialize\r\n      ========================================================================== */\r\ndocument.addEventListener(\"DOMContentLoaded\", init);\r\nfunction init() {\r\n  //do stuff after page has loaded\r\n  getOverview(); //get latest donors and top donors\r\n}\r\n\r\n/* ==========================================================================\r\n      Functions\r\n      ========================================================================== */\r\nconst slider = document.getElementById(\"myRange\");\r\nconst sliderInput = document.querySelector(\".slidecontainer .amount input\");\r\nconst sliderInputLine = document.querySelector(\".slidecontainer .amount .line\");\r\nlet allowStep2 = true;\r\n\r\nslider.oninput = function() {\r\n  console.log(this.value);\r\n  sliderInput.value = this.value;\r\n};\r\n\r\nsliderInput.addEventListener(\"input\", checkInput);\r\n\r\n//Check input for number and handle if not\r\nfunction checkInput(e) {\r\n  console.log(e.target.value);\r\n  //check if value is a valid number (even number as strings)\r\n  if (isNaN(e.target.value)) {\r\n    //is not a number\r\n    console.log(\"Not a number\");\r\n    allowStep2 = false;\r\n    sliderInputLine.style.background = \"red\";\r\n    step1Button.style.background = \"#acacac\";\r\n  } else {\r\n    //is a number\r\n    console.log(\"Nummberr\");\r\n    allowStep2 = true;\r\n    slider.value = e.target.value;\r\n    sliderInputLine.style.removeProperty(\"background\");\r\n    step1Button.style.removeProperty(\"background\");\r\n  }\r\n}\r\n\r\n//Change monthly/yearly\r\nlet dropdownOpen = false;\r\nlet currentPeriod = \"monthly\";\r\nconst dropdown = document.querySelector(\"#step-1 .dropdown\");\r\nlet dropdownLIS;\r\nconst dropdownUL = document.querySelector(\"#step-1 .dropdown ul\");\r\nconst dropdownLine = document.querySelector(\"#step-1 .dropdown .line\");\r\n\r\n// Open/close period dropdown (monthly, yearly)\r\ndropdown.addEventListener(\"click\", toggleDropdown);\r\n\r\nfunction toggleDropdown() {\r\n  if (dropdownOpen) {\r\n    //close dropdown\r\n    dropdown.style.removeProperty(\"height\");\r\n    dropdownLine.style.removeProperty(\"width\");\r\n  } else {\r\n    //open dropdown\r\n    dropdown.style.height = \"60px\";\r\n    dropdownLine.style.width = \"0px\";\r\n  }\r\n  dropdownOpen = !dropdownOpen;\r\n}\r\n\r\n//Change between period with refreshing onclick\r\nfunction addClickEventToLI() {\r\n  dropdownLIS = document.querySelectorAll(\"#step-1 .dropdown li\");\r\n  dropdownLIS.forEach(li => {\r\n    li.addEventListener(\"click\", togglePeriod);\r\n  });\r\n}\r\naddClickEventToLI();\r\nfunction togglePeriod(e) {\r\n  console.log(e.target.textContent);\r\n  currentPeriod = e.target.textContent;\r\n  if (currentPeriod === \"monthly\") {\r\n    dropdownUL.innerHTML = `<li><strong>monthly</strong></li><li><strong>yearly</strong></li>`;\r\n  } else {\r\n    dropdownUL.innerHTML = `<li><strong>yearly</strong></li><li><strong>monthly</strong></li>`;\r\n  }\r\n  addClickEventToLI();\r\n}\r\n\r\n//############################################\r\n//Session storage\r\n\r\n// Save data to sessionStorage\r\nconst step1Button = document.querySelector(\"#step-1 .step1Button\");\r\n\r\nstep1Button.addEventListener(\"click\", proceedToStep2);\r\n\r\nfunction proceedToStep2(e) {\r\n  if (!allowStep2) {\r\n    //if donation amount is not a number, dont allow to continue\r\n    e.preventDefault();\r\n  }\r\n\r\n  const donationInput = document.querySelector(\"#step-1 .slider\");\r\n  const checkBox = document.querySelector(\"#step-1 #checkbox\");\r\n  const type = checkBox.checked ? currentPeriod : \"one-time\";\r\n\r\n  // A data object to be stored\r\n  const step1Data = {\r\n    amount: donationInput.value,\r\n    type: type,\r\n    currency: \"$\"\r\n  };\r\n\r\n  sessionStorage.setItem(\"step1Data\", JSON.stringify(step1Data));\r\n}\r\nlet overview = {};\r\nconst recentDonorsTemplate = document.querySelector(\"#recent-donors-template\")\r\n  .content;\r\nconst topDonorsTemplate = document.querySelector(\"#top-donors-template\")\r\n  .content;\r\n\r\n//Get overview of latets three donations and top three donators\r\nfunction getOverview() {\r\n  db.collection(\"overview_visitor\")\r\n    .get()\r\n    .then(function(querySnapshot) {\r\n      querySnapshot.forEach(function(doc) {\r\n        // doc.data() is never undefined for query doc snapshots\r\n        console.log(\"Your document data is: \", doc.data());\r\n        overview = doc.data();\r\n        displayRecentDonors();\r\n        displayTopDonors();\r\n      });\r\n    })\r\n    .catch(function(error) {\r\n      console.log(\"Error getting documents: \", error);\r\n    });\r\n}\r\n\r\nfunction displayRecentDonors() {\r\n  const recentDonors = document.querySelector(\"#recentdonors-grid\");\r\n\r\n  overview.latestDonations.forEach(elem => {\r\n    let clone = recentDonorsTemplate.cloneNode(true);\r\n    clone.querySelector(\".card-content p\").textContent = elem.name;\r\n    clone.querySelector(\".card-content2 p\").textContent =\r\n      elem.amount + overview.currency;\r\n    recentDonors.appendChild(clone);\r\n  });\r\n}\r\n\r\nfunction displayTopDonors() {\r\n  const topDonors = document.querySelector(\"#topdonors-grid\");\r\n\r\n  overview.topDonors.forEach(elem => {\r\n    let clone = topDonorsTemplate.cloneNode(true);\r\n    clone.querySelector(\".card-content p\").textContent = elem.name;\r\n    clone.querySelector(\".card-content2 p\").textContent =\r\n      elem.amount + overview.currency;\r\n    topDonors.appendChild(clone);\r\n  });\r\n}\r\n"]}